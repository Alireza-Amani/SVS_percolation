MODULE MODD_CONST_ATM

!##########################
!
!! *MODD_CONST_ATM*
!!
!! Constants for atmospheric transmittance calculation (Radiative transfer in the atmosphere)

!!
!!**  IMPLICIT ARGUMENTS
!!    ------------------
!!       NONE          
!!
!!    REFERENCE
!!    ---------
!!
!!    AUTHOR
!!    ------
!!    M. Dumont        * Meteo France *
!!   adapted from SBDART (spectra.f) Richiazzi et al., 1998
!!
!!    MODIFICATIONS
!!    -------------
!!      M Dumont    11/2013 
!--------------------------------------------------------------------------------

IMPLICIT NONE


INTEGER,PARAMETER::JPNBANDS_ATM=186 ! number of bands
!Wavelength of each band (nanometers)
REAL,DIMENSION(JPNBANDS_ATM),PARAMETER::PPWAVELENGTHS_ATM=(/300,320,340,360,380,400,420,440,460,480,500,520,540,560,580,600,&
620,640,660,680,700,720,740,760,780,800,820,840,860,880,900,920,940,960,980,1000,1020,1040,1060,&
1080,1100,1120,1140,1160,1180,1200,1220,1240,1260,1280,1300,1320,1340,1360,1380,1400,1420,1440,&
1460,1480,1500,1520,1540,1560,1580,1600,1620,1640,1660,1680,1700,1720,1740,1760,1780,1800,1820,&
1840,1860,1880,1900,1920,1940,1960,1980,2000,2020,2040,2060,2080,2100,2120,2140,2160,2180,2200,&
2220,2240,2260,2280,2300,2320,2340,2360,2380,2400,2420,2440,2460,2480,2500,2520,2540,2560,2580,2600,&
2620,2640,2660,2680,2700,2720,2740,2760,2780,2800,2820,2840,2860,2880,2900,2920,2940,2960,2980,3000,&
3020,3040,3060,3080,3100,3120,3140,3160,3180,3200,3220,3240,3260,3280,3300,3320,3340,3360,3380,3400,&
3420,3440,3460,3480,3500,3520,3540,3560,3580,3600,3620,3640,3660,3680,3700,3720,3740,3760,3780,3800,&
3820,3840,3860,3880,3900,3920,3940,3960,3980,4000/)
REAL, PARAMETER :: PPCONV=1000. ! nm to microns


REAL, PARAMETER :: PPMU_THRESHOLD=0.002 ! threshold to disable computation for to high sun angles


! Snow reference spectrum for the ground from DISORT pure snow, SSA=5 mÂ²kg-1, diffuse albedo
REAL,DIMENSION(JPNBANDS_ATM),PARAMETER::PPALB_SOIL=(/0.99243486 ,0.99243486 ,0.99243486,& 
  0.99274123, 0.99239236, 0.99302906 ,0.99267286 ,0.99233246 ,0.98985350,0.98565942,0.98047960,& 
  0.97438073,0.96694368, 0.95929444, 0.95151269,0.94474888,0.93362015,0.92247176,0.91136730,0.90243953,&   
  0.88757420, 0.87003529,0.85996813, 0.83650166,0.80952191,0.78731966,0.78349495,0.78023678,0.74679261,&  
  0.69847101,0.67263699,0.65929186,0.64107448, 0.59923589, 0.54118091,0.48383781,0.43145150,0.42857611,&     
  0.46117070,0.48408738,0.49089652,0.48230857,0.44923174,0.40071270,0.32686794,0.27359405,0.21258692 ,&       
  0.18979894,0.18127942,0.18225683,0.18512979,0.18702042,0.18678117,0.18099827,0.16892113,0.14325121,&    
  5.17073944E-02,1.80249438E-02,8.96544661E-03, 6.44877553E-03, 6.17813086E-03,6.38595084E-03,&
  6.76405523E-03,7.42717972E-03,8.59121233E-03,9.88863781E-03,1.10637136E-02,1.19847544E-02,&
  1.32433400E-02,1.49351256E-02, 1.67238489E-02,1.87131334E-02, 2.05525476E-02, 2.21590567E-02,&    
  2.34354697E-02, 2.47700345E-02,2.66666394E-02,2.75928248E-02,2.51036286E-02,1.65992118E-02,&    
  9.27010551E-03,5.97111741E-03, 5.24788443E-03,5.12806978E-03,5.09503623E-03,5.07903472E-03,&     
 5.06461365E-03,5.05770463E-03,5.07073803E-03,5.15591167E-03,5.45999687E-03,6.23114547E-03,&
 7.68721942E-03,9.76279099E-03,1.22047402E-02,1.46791702E-02,1.72116738E-02,1.92457475E-02,&      
 1.88754015E-02,1.63767040E-02,1.32020889E-02,1.03982445E-02,8.47747922E-03,7.32079148E-03,&       
 6.67320145E-03,6.26953458E-03,5.96560724E-03,5.68637997E-03, 5.41059906E-03,5.17143542E-03,&
 4.94981697E-03,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,&
 0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,&
 0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0./)
 
!same in meters
REAL,DIMENSION(JPNBANDS_ATM),PARAMETER::PPWAVELENGTHS_M=1.0E-9*PPWAVELENGTHS_ATM

!REAL,DIMENSION(JPNBANDS),SAVE::XEXTRA_SUN

! Extraterrestrial solar irradiance (lowtran7)

INTEGER,PARAMETER::JPNBANDS_REF_SUN=371 ! number of reference bands

! Extra_terrestrial irradiance (lowtran7)  wavelength (nm) , irradiance (W m-2/microns)
REAL, DIMENSION(JPNBANDS_REF_SUN), PARAMETER :: PPWAVE_SUN_REF=(/300,&
310,320,330,340,350,360,370,380,390,400,410,420,430,440,450,460,470,480,490,500,&
510,520,530,540,550,560,570,580,590,600,610,620,630,640,650,660,670,680,690,700,&
710,720,730,740,750,760,770,780,790,800,810,820,830,840,850,860,870,880,890,900,&
910,920,930,940,950,960,970,980,990,1000,1010,1020,1030,1040,1050,1060,1070,1080,1090,1100,&
1110,1120,1130,1140,1150,1160,1170,1180,1190,1200,1210,1220,1230,1240,1250,1260,1270,1280,1290,1300,&
1310,1320,1330,1340,1350,1360,1370,1380,1390,1400,1410,1420,1430,1440,1450,1460,1470,1480,1490,1500,&
1510,1520,1530,1540,1550,1560,1570,1580,1590,1600,1610,1620,1630,1640,1650,1660,1670,1680,1690,1700,&
1710,1720,1730,1740,1750,1760,1770,1780,1790,1800,1810,1820,1830,1840,1850,1860,1870,1880,1890,1900,&
1910,1920,1930,1940,1950,1960,1970,1980,1990,2000,2010,2020,2030,2040,2050,2060,2070,2080,2090,2100,&
2110,2120,2130,2140,2150,2160,2170,2180,2190,2200,2210,2220,2230,2240,2250,2260,2270,2280,2290,2300,&
2310,2320,2330,2340,2350,2360,2370,2380,2390,2400,2410,2420,2430,2440,2450,2460,2470,2480,2490,2500,&
2510,2520,2530,2540,2550,2560,2570,2580,2590,2600,2610,2620,2630,2640,2650,2660,2670,2680,2690,2700,&
2710,2720,2730,2740,2750,2760,2770,2780,2790,2800,2810,2820,2830,2840,2850,2860,2870,2880,2890,2900,&
2910,2920,2930,2940,2950,2960,2970,2980,2990,3000,&
3010,3020,3030,3040,3050,3060,3070,3080,3090,3100,3110,3120,3130,3140,3150,3160,3170,3180,3190,3200,&
3210,3220,3230,3240,3250,3260,3270,3280,3290,3300,3310,3320,3330,3340,3350,3360,3370,3380,3390,3400,&
3410,3420,3430,3440,3450,3460,3470,3480,3490,3500,3510,3520,3530,3540,3550,3560,3570,3580,3590,3600,&
3610,3620,3630,3640,3650,3660,3670,3680,3690,3700,3710,3720,3730,3740,3750,3760,3770,3780,3790,3800,&
3810,3820,3830,3840,3850,3860,3870,3880,3890,3900,3910,3920,3930,3940,3950,3960,3970,3980,3990,4000/)
REAL,DIMENSION(JPNBANDS_REF_SUN),PARAMETER::PPEXTRA_SUN=&
(/ 440.,   437.20001,   886.79999,   1269.0000,   1201.0000,   1079.0000,   1137.0000,   1264.0000,   1102.0000,&
   1296.0000,   1653.0000,   1602.0000,   1715.0000,   1278.0000,   1817.0000,   2051.0000,   2036.0000,   1938.0000,&
   2070.0000,   1982.0000,   1966.0000,   1923.0000,   1841.0000,   1926.0000,   1793.0000,   1897.0000,&
   1832.0000,   1855.0000,   1824.0000,   1649.0000,   1775.0000,   1735.0000,   1717.0000,   1674.0000,&
   1648.0000,   1568.0000,   1578.0000,   1546.0000,   1501.0000,   1460.0000,   1424.0000,   1388.0000,&
   1330.0000,   1325.0000,   1271.0000,   1270.0000,   1241.0000,   1205.0000,   1191.0000,   1171.0000,&
   1141.0000,   1101.0000,   1070.0000,   1076.0000,   1044.0000,   978.79999,   999.90002,   977.09998,&
   963.40002,   948.09998,   911.09998,   863.90002,   854.59998,   831.09998,   806.00000,   779.59998,&
   769.29999,   772.20001,   768.90002,   761.50000,   742.40002,   736.59998,   717.29999,   703.29999,&
   687.79999,   682.29999,   646.70001,   642.50000,   625.20001,   614.09998,   601.00000,   601.40002,&
   586.50000,   567.90002,   561.00000,   551.00000,   553.00000,   530.50000,   520.70001,   512.00000,&
   499.60001,   493.29999,   493.39999,   482.20001,   477.50000,   467.50000,   455.00000,   437.10001,&
   449.00000,   438.70001,   438.10001,   425.89999,   416.20001,   408.20001,   400.60001,   393.60001,&
   381.29999,   369.10001,   367.79999,   362.29999,   357.00000,   349.20001,   344.39999,   345.60001,&
   331.70001,   320.50000,   309.60001,   313.20001,   305.70001,   299.10001,   300.50000,   295.29999,&
   288.00000,   287.79999,   274.39999,   273.89999,   271.79999,   263.39999,   258.70001,   251.80000, &
   246.10001,   242.80000,   242.30000,   243.10001,   235.80000,   234.39999,   233.89999,   230.00000,&
   221.10001,   219.20000,   216.50000,   212.89999,   209.60001,   202.00000,   189.39999,   186.00000,&
   187.89999,   181.89999,   172.30000,   170.30000,   171.39999,   168.39999,   159.70000,   157.60001,&
   151.60001,   151.89999,   144.50000,   142.60001,   137.30000,   138.39999,   137.39999,   136.20000,&
   136.70000,   133.70000,   130.70000,   127.90000,   125.00000,   125.20000,   127.10000,   124.60000,&
   122.00000,   113.80000,   113.90000,   112.40000,   110.00000,   105.10000,   101.80000,   100.00000,&
   100.60000,   100.30000,   98.120003,   92.000000,   88.360001,   86.239998,   84.980003,   82.669998,&
   80.879997,   80.199997,   78.040001,   74.889999,   73.209999,   73.610001,   74.879997,   75.260002,&
   74.330002,   72.769997,   71.660004,   70.940002,   69.870003,   69.059998,   68.349998,   64.639999,&
   57.480000,   53.070000,   55.150002,   60.650002,   64.410004,   61.970001,   61.970001,   56.080002,&
   53.270000,   54.410000,   56.549999,   55.709999,   52.150002,   52.150002,   50.709999,   52.169998,&
   54.080002,   54.369999,   54.369999,   51.990002,   48.330002,   46.279999,   45.980000,   45.980000,&
   45.520000,   44.349998,   43.080002,   43.080002,   42.130001,   41.570000,   40.930000,   40.930000,&
   39.860001,   38.889999,   38.400002,   38.400002,   37.889999,   36.990002,   36.990002,   36.029999,&
   35.400002,   35.400002,   35.000000,   34.599998,   34.599998,   33.970001,   33.090000,   33.090000,&
   32.220001,   31.670000,   31.670000,   31.250000,   31.250000,   30.530001,   29.570000,   29.570000,&
   28.820000,   28.820000,   28.420000,   27.980000,   27.980000,   27.209999,   27.209999,   26.309999,&
   25.650000,   25.650000,   25.240000,   25.240000,   24.830000,   24.830000,   24.330000,   24.330000,&
   23.900000,   23.580000,   23.580000,   23.190001,   23.190001,   22.570000,   22.570000,   21.770000,&
   21.770000,   21.020000,   21.020000,   20.510000,   20.510000,   20.160000,   20.160000,   19.840000,&
   19.840000,   19.490000,   19.490000,   19.139999,   19.139999,   18.910000,   18.910000,   18.730000,&
   18.730000,   18.430000,   18.430000,   18.430000,   17.959999,   17.959999,   17.469999,   17.469999,&
   17.080000,   17.080000,   16.770000,   16.770000,   16.770000,   16.430000,   16.430000,   16.010000,&
   16.010000,   15.530000,   15.530000,   15.530000,   15.070000,   15.070000,   14.660000,   14.660000,&
   14.660000,   14.320000,   14.320000,   14.040000,   14.040000,   14.040000,   13.780000,   13.780000,&
   13.530000,   13.530000,   13.530000,   13.250000,   13.250000,   12.930000,   12.930000,   12.930000,&
   12.600000,   12.600000,   12.600000,   12.250000,   12.250000,   12.250000,   11.900000,   11.900000,&
   11.550000,   11.550000,   11.550000,   11.230000,   11.230000,   11.230000,   10.950000,   10.950000,&
   10.950000,   10.700000,   10.700000,   10.700000,   10.480000,   10.480000,  10.480000,   10.250000,  & 
   10.250000,   10.250000,   10.010000,   10.010000,   10.010000,   9.7550001,   9.7550001,   9.7550001,   9.7550001/)

REAL, PARAMETER :: PPPZERO=1013.25       ! standard pressure (mb)
REAL, PARAMETER :: PPTZERO=273.15        ! standard temperature (K)

! Rayleigh scaterring parameter approximation of shettle et al., 1980 (appl. opt., 2873-4)
!    with the depolarization = 0.0279 instead of 0.035
!    for temperature = 273 k & pressure = 1 atm.
REAL, PARAMETER  :: PPFIT1=9.38076e+18
REAL, PARAMETER  :: PPFIT2=-1.08426e+09
REAL, PARAMETER  :: PPRE=6371.2           ! radius of earth (km)
REAL, PARAMETER  :: PPMO=2.6568e-23      ! oxygen atomic mass (g)
REAL, PARAMETER  :: PPGRAV=9.80665        ! gravitational acceleration (m/s/s)
REAL, PARAMETER  :: PPBIGEXP=87.
REAL, PARAMETER  :: PPAIRRHO=1.273        ! air density at stp (kg m-3)
REAL, PARAMETER  :: PPAWLMAX=20.          ! maximum exponent
REAL, PARAMETER  :: PPAMFAC=10.*PPGRAV*PPAIRRHO/PPPZERO ! convert scale height to airmass
REAL, PARAMETER	 :: PPATMOS_R=8.31432 ! Universal gas constant (J deg-1 kmol-1)
REAL, PARAMETER	 :: PPATMOS_T0=288.15 ! Standard sea-level Temperature (K)
REAL, PARAMETER  :: PPEARTH_G=9.80665 !  Acceleration due to gravity (m s-2)
REAL, PARAMETER  :: PPSTLAPSE=-0.0065 ! standard lapse rate K/m
REAL, PARAMETER  :: PPMD = 28.966 !Molecular weight of dry air (kg.mol-1)
REAL, PARAMETER  :: PPREARTH= 6.356766e+6 ! Average earth's radius (m) for geopotent
REAl, PARAMETER  :: PPPAVO=6.02214129e+23 ! Avogadro number (mol-1)

! absorption parameters for gaz (bird and riordan, 1986)
INTEGER,PARAMETER::JPNBANDS_REF_ABS=122
REAL, DIMENSION(JPNBANDS_REF_ABS),PARAMETER::PPWAVE_SUN_ABS=(/&
0.3 ,0.305, 0.31, 0.315 ,0.32 ,0.325 ,0.33, 0.335 ,0.34 ,0.345 ,0.35, 0.36, 0.37, 0.38, 0.39, 0.4, 0.41 ,&
0.42 ,0.43, 0.44, 0.45, 0.46, 0.47, 0.48, 0.49, 0.5, 0.51, 0.52, 0.53,0.54, 0.55, 0.57, 0.593, 0.61, 0.63, &
0.656, 0.6676, 0.69, 0.71, 0.718, 0.7244, 0.74, 0.7525, 0.7575, 0.7625, 0.7675,  0.78, 0.8, 0.816, 0.8237, &
0.8315, 0.84, 0.86, 0.88,0.905, 0.915, 0.925, 0.93, 0.937 ,0.948, 0.965, 0.98, 0.9935, 1.04, 1.07, 1.1, &
1.12, 1.13, 1.145, 1.161, 1.17, 1.2, 1.24, 1.27, 1.29, 1.32, 1.35, 1.395, 1.4425, 1.4625, 1.477, 1.497, &
1.52, 1.539, 1.558, 1.578, 1.592, 1.61, 1.63, 1.646, 1.678, 1.74, 1.8, 1.86, 1.92, 1.96, 1.985, 2.005,&
2.035, 2.065, 2.1, 2.148, 2.198, 2.27, 2.36, 2.45, 2.5, 2.6, 2.7, 2.8, 2.9, 3.0, 3.1, 3.2, 3.3, 3.4, &
3.5, 3.6, 3.7, 3.8, 3.9, 4.0/)
REAL, DIMENSION(JPNBANDS_REF_ABS),PARAMETER::PPAW=(/& ! water vapour
0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,&
0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,&
0.0, 0.0, 0.075,0.0, 0.0, 0.0, 0.0, 0.016, 0.0125, 1.8, 2.5, 0.061, 0.0008,&
0.0001, 0.00001, 0.00001, 0.0006, 0.036, 1.6, 2.5, 0.5, 0.155, 0.00001, 0.0026, &
7.0, 5.0, 5.0, 27.0, 55.0, 45.0, 4.0, 1.48, 0.1, 0.00001, 0.001, 3.2, 115.0, 70.0, 75.0, &
10.0, 5.0, 2.0, 0.002, 0.002, 0.1, 4.0, 200.0, 1000.0, 185.0,80.0,80.0, 12.0, 0.16, 0.002, &
0.0005, 0.0001, 0.00001, 0.0001, 0.001, 0.01, 0.036, 1.1, 130.0, 1000.0, 500.0, 100.0, 4.0, &
2.9, 1.0, 0.4, 0.22, 0.25, 0.33, 0.5, 4.0, 80.0, 310.0, 15000.0, 22000.0, 8000.0, 650.0, &
240.0, 230.0, 100.0, 120.0, 19.5, 3.6, 3.1, 2.5, 1.4, 0.17, 0.0045/)
REAL, DIMENSION(JPNBANDS_REF_ABS),PARAMETER::PPAO=(/& ! ozone
10.0, 4.8, 2.7, 1.35, 0.8, 0.38, 0.16, 0.075, 0.04, 0.019, 0.007, 0.0, 0.0, 0.0, 0.0, 0.0,&
0.0, 0.0, 0.0, 0.0, 0.003, 0.006, 0.009, 0.014, 0.021, 0.03, 0.04, 0.048, 0.063, 0.075, 0.085,&
0.12, 0.119, 0.12, 0.09, 0.065, 0.051, 0.028, 0.018, 0.015, 0.012, 0.01, 0.008, 0.007, 0.006,&
0.005, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,0.0, 0.0, 0.0, 0.0,&
0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,&
0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,&
0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0/)
REAL, DIMENSION(JPNBANDS_REF_ABS),PARAMETER::PPAU=(/& ! uniformely miwed gaz
0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,&
0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.15,&
0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.35, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,&
0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.05, 0.3, 0.02, 0.0002,&
0.00011, 0.00001, 0.05, 0.011, 0.005, 0.0006, 0.0, 0.005, 0.13, 0.04, 0.06, 0.13, 0.001, 0.0014, &
0.0001, 0.00001, 0.00001,  0.0001, 0.001 , 4.3, 0.2 ,21.0, 0.13, 1.0, 0.08, 0.001, 0.00038,&
0.001, 0.0005, 0.00015, 0.00014, 0.00066 ,100.0, 150.0,0.13, 0.0095, 0.001, 0.8, 1.9, 1.3,&
0.075, 0.01, 0.00195, 0.004, 0.29, 0.025/)

!!!! Aerosols scatering and abosrption
!!!! from SBDART rural aerosols model
INTEGER,PARAMETER ::JPNBANDS_REF_AER=47! number of wavelengths for standard BLA and strat models
REAL, DIMENSION(JPNBANDS_REF_AER),PARAMETER::PPWAVE_SUN_AER=(/& ! wavelengths (microns) for standard BLA and strat models
        .2000,   .3000,   .3371,   .5500,   .6943,  1.0600,  1.5360,&	
       2.0000,  2.2500,  2.5000,  2.7000,  3.0000,  3.3923,  3.7500,&
       4.5000,  5.0000,  5.5000,  6.0000,  6.2000,  6.5000,  7.2000,&
       7.9000,  8.2000,  8.7000,  9.0000,  9.2000, 10.0000, 10.5910,&
      11.0000, 11.5000, 12.5000, 14.8000, 15.0000, 16.4000, 17.2000,&
      18.5000, 21.3000, 25.0000, 30.0000, 40.0000, 50.0000, 60.0000,&
      80.0000, 100.000, 150.000, 200.000, 300.000/)
REAL, DIMENSION(JPNBANDS_REF_AER),PARAMETER::PPRUR_EXT_1=(/& ! extinction efficiency first humidity domain
      2.09291, 1.74582, 1.60500, 1.00000,  .75203,  .41943,  .24070,&
       .14709,  .13304,  .12234,  .13247,  .11196,  .10437,  .09956,&
       .09190,  .08449,  .07861,  .07025,  .07089,  .07196,  .07791,&
       .04481,  .04399,  .12184,  .12658,  .12829,  .09152,  .08076,&
       .07456,  .06880,  .06032,  .04949,  .05854,  .06000,  .06962,&
      .05722,  .06051,  .05177,  .04589,  .04304,&
       .03582,  .03155,  .02018,  .01469,  .00798,  .00551, 0./)
 REAL, DIMENSION(JPNBANDS_REF_AER),PARAMETER::PPRUR_EXT_2=(/& ! extinction efficiency second humidity domain    
     2.09544, 1.74165, 1.59981, 1.00000,  .75316,  .42171,  .24323,&
       .15108,  .13608,  .12430,  .13222,  .13823,  .11076,  .10323,&
       .09475,  .08728,  .08076,  .07639,  .07797,  .07576,  .07943,&
       .04899,  .04525,  .12165,  .12741,  .12778,  .09032,  .07962,&
       .07380,  .06880,  .06329,  .05791,  .06646,  .06639,  .07443,&
       .06304,  .06443,  .05538,  .04867,  .04519,&
       .03821,  .03374,  .02173,  .01587,  .00862,  .00594, 0./)
 REAL, DIMENSION(JPNBANDS_REF_AER),PARAMETER::PPRUR_EXT_3=(/& ! extinction efficiency 3rd humidity domain         
     2.07082, 1.71456, 1.57962, 1.00000,  .76095,  .43228,  .25348,&
       .16456,  .14677,  .13234,  .13405,  .20316,  .12873,  .11506,&
       .10481,  .09709,  .08918,  .09380,  .09709,  .08791,  .08601,&
       .06247,  .05601,  .11905,  .12595,  .12348,  .08741,  .07703,&
       .07266,  .07044,  .07443,  .08146,  .08810,  .08563,  .08962,&
       .08051,  .07677,  .06658,  .05747,  .05184,&
       .04572,  .04074,  .02689,  .01981,  .01084,  .00714, 0./)
 REAL, DIMENSION(JPNBANDS_REF_AER),PARAMETER::PPRUR_EXT_4=(/& ! extinction efficiency 4th humidity domain        
      1.66076, 1.47886, 1.40139, 1.00000,  .80652,  .50595,  .32259,&
       .23468,  .20772,  .18532,  .17348,  .35114,  .20006,  .17386,&
       .16139,  .15424,  .14557,  .16215,  .16766,  .14994,  .14032,&
       .12968,  .12601,  .13551,  .13582,  .13228,  .11070,  .09994,&
       .09873,  .10418,  .13241,  .15924,  .16139,  .15949,  .15778,&
       .15184,  .13848,  .12563,  .11076,  .09601,&
       .09312,  .08720,  .06644,  .05264,  .03181,  .02196, 0.0/)

  REAL, DIMENSION(JPNBANDS_REF_AER),PARAMETER::PPRUR_ABS_1=(/& ! absorption 1st humidity domain  
       .67196,  .11937,  .08506,  .05930,  .05152,  .05816,  .05006,&
       .01968,  .02070,  .02101,  .05652,  .02785,  .01316,  .00867,&
       .01462,  .01310,  .01627,  .02013,  .02165,  .02367,  .03538,&
       .02823,  .03962,  .06778,  .07285,  .08120,  .04032,  .03177,&
       .02557,  .02342,  .02177,  .02627,  .03943,  .03114,  .03696,&
       .02956,  .03500,  .03241,  .03297,  .03380,&
       .03170,  .02794,  .01769,  .01305,  .00730,  .00518, 0.0/)
  REAL, DIMENSION(JPNBANDS_REF_AER),PARAMETER::PPRUR_ABS_2=(/& ! absorption 2nd humidity domain  
       .62968,  .10816,  .07671,  .05380,  .04684,  .05335,  .04614,&
       .01829,  .01899,  .01962,  .05525,  .06816,  .01652,  .00867,&
       .01544,  .01373,  .01627,  .02892,  .02829,  .02532,  .03487,&
       .02835,  .03854,  .06684,  .07272,  .08038,  .03987,  .03247,&
       .02816,  .02816,  .03101,  .03741,  .04829,  .04032,  .04399,&
       .03734,  .03956,  .03601,  .03525,  .03563,&
      .03357,  .02965,  .01887,  .01395,  .00782,  .00555, 0.0/)
  REAL, DIMENSION(JPNBANDS_REF_AER),PARAMETER::PPRUR_ABS_3=(/& ! absorption 3rd humidity domain  
       .51899,  .08278,  .05816,  .04082,  .03570,  .04158,  .03620,&
       .01513,  .01481,  .01633,  .05278,  .13690,  .02494,  .00886,&
       .01804,  .01582,  .01677,  .04816,  .04367,  .03013,  .03443,&
       .02930,  .03677,  .06209,  .06911,  .07475,  .03892,  .03494,&
       .03513,  .03968,  .05152,  .06241,  .06937,  .06203,  .06215,&
       .05614,  .05209,  .04608,  .04196,  .04095,&
       .03916,  .03486,  .02262,  .01686,  .00951,  .00674, 0.0/)
  REAL, DIMENSION(JPNBANDS_REF_AER),PARAMETER::PPRUR_ABS_4=(/& ! absorption 4th humidity domain  
       .21943,  .02848,  .01943,  .01342,  .01171,  .01437,  .01323,&
       .01152,  .00696,  .01329,  .06108,  .24690,  .05323,  .01430,&
       .03361,  .02949,  .02652,  .09437,  .08506,  .05348,  .04627,&
       .04380,  .04557,  .05380,  .05715,  .05899,  .04861,  .05253,&
       .06171,  .07437,  .10152,  .12019,  .12190,  .11734,  .11411,&
       .10766,  .09487,  .08430,  .07348,  .06861,&
       .06936,  .06458,  .04735,  .03761,  .02313,  .01668, 0.0/)

  REAL, DIMENSION(JPNBANDS_REF_AER),PARAMETER::PPRUR_G_1=(/& ! assymetry 1st humidity domain  
       .7581,   .6785,   .6712,   .6479,   .6342,   .6176,   .6334,&
       .7063,   .7271,   .7463,   .7788,   .7707,   .7424,   .7312,&
       .7442,   .7516,   .7662,   .7940,   .7886,   .7797,   .7664,&
       .8525,   .8700,   .5846,   .5570,   .5992,   .6159,   .6271,&
       .6257,   .6374,   .6546,   .6861,   .6859,   .6120,   .5570,&
       .5813,   .5341,   .5284,   .5137,   .4348,   .4223,   .3775,&
       .3435,   .3182,   .2791,   .2494,   .0000/)
  REAL, DIMENSION(JPNBANDS_REF_AER),PARAMETER::PPRUR_G_2=(/& ! assymetry 2nd humidity domain 
       .7632,   .6928,   .6865,   .6638,   .6498,   .6314,   .6440,&
       .7098,   .7303,   .7522,   .7903,   .7804,   .7380,   .7319,&
       .7508,   .7584,   .7738,   .8071,   .7929,   .7843,   .7747,&
       .8507,   .8750,   .6112,   .5851,   .6272,   .6466,   .6616,&
       .6653,   .6798,   .6965,   .7026,   .6960,   .6360,   .5848,&
       .6033,   .5547,   .5445,   .5274,   .4518,   .4318,   .3863,&
       .3516,   .3257,   .2853,   .2548,   .0000/)
  REAL, DIMENSION(JPNBANDS_REF_AER),PARAMETER::PPRUR_G_3=(/& ! assymetry 3rd humidity domain 
       .7725,   .7240,   .7197,   .6997,   .6858,   .6650,   .6702,&
       .7181,   .7378,   .7653,   .8168,   .7661,   .7286,   .7336,&
       .7654,   .7735,   .7910,   .8303,   .8025,   .7957,   .7946,&
       .8468,   .8734,   .6831,   .6619,   .6994,   .7250,   .7449,&
       .7547,   .7665,   .7644,   .7265,   .7170,   .6769,   .6409,&
       .6442,   .6031,   .5854,   .5646,   .4977,   .4602,   .4127,&
       .3751,   .3476,   .3048,   .2721,   .0000/)
  REAL, DIMENSION(JPNBANDS_REF_AER),PARAMETER::PPRUR_G_4=(/& ! assymetry 4th humidity domain 
       .7778,   .7793,   .7786,   .7717,   .7628,   .7444,   .7365,&
       .7491,   .7609,   .7921,   .8688,   .7537,   .7294,   .7413,&
       .7928,   .8016,   .8225,   .8761,   .8359,   .8285,   .8385,&
       .8559,   .8654,   .8414,   .8415,   .8527,   .8740,   .8903,&
       .8952,   .8923,   .8611,   .8033,   .7989,   .7758,   .7632,&
       .7508,   .7314,   .7091,   .6867,   .6419,   .5790,   .5259,&
       .4749,   .4415,   .3886,   .3489,   .0000/)

REAL, PARAMETER :: PPDEGPDAY=360./365.242 ! degree per day
REAL, PARAMETER :: PPECCEN=0.01671        ! eccentricity of earth orbit
REAL, PARAMETER :: PPDAYPH=2.              ! day of perihelion
REAL, PARAMETER :: PPPI=3.1415926536

!!! Atmospheric vertical profile of water vapour and ozone (ref mid latitude winter, SBDART,mc'clatchey)
INTEGER, PARAMETER :: JPNPREF= 33! number of layer of the vertical profile 
REAL, DIMENSION(JPNPREF), PARAMETER::PPPREF=(/& ! pressure vertical profile (mb)
          1.018e+03,8.973e+02,7.897e+02,6.938e+02,6.081e+02,5.313e+02,&     
          4.627e+02,4.016e+02,3.473e+02,2.992e+02,2.568e+02,2.199e+02,&     
          1.882e+02,1.610e+02,1.378e+02,1.178e+02,1.007e+02,8.610e+01,&     
          7.350e+01,6.280e+01,5.370e+01,4.580e+01,3.910e+01,3.340e+01,&     
          2.860e+01,2.430e+01,1.110e+01,5.180e+00,2.530e+00,1.290e+00,&      
	  6.820e-01,4.670e-02,3.000e-04/)         
REAL, DIMENSION(JPNPREF), PARAMETER::PPVAPREF=(/&! water vapour density
	3.500e+00,2.500e+00,1.800e+00,1.200e+00,6.600e-01,3.800e-01,&      
	2.100e-01,8.500e-02,3.500e-02,1.600e-02,7.500e-03,6.900e-03,&      
	6.000e-03,1.800e-03,1.000e-03,7.600e-04,6.400e-04,5.600e-04,&      
	5.000e-04,4.900e-04,4.500e-04,5.100e-04,5.100e-04,5.400e-04,&      
	6.000e-04,6.700e-04,3.600e-04,1.100e-04,4.300e-05,1.900e-05,&      
	6.300e-06,1.400e-07,1.000e-09/)  
REAL, DIMENSION(JPNPREF), PARAMETER::PPOZOREF=(/&! ozone density
	6.000e-05,5.400e-05,4.900e-05,4.900e-05,4.900e-05,5.800e-05,&      
	6.400e-05,7.700e-05,9.000e-05,1.200e-04,1.600e-04,2.100e-04,&     
	2.600e-04,3.000e-04,3.200e-04,3.400e-04,3.600e-04,3.900e-04,&      
	4.100e-04,4.300e-04,4.500e-04,4.300e-04,4.300e-04,3.900e-04,&      
	3.600e-04,3.400e-04,1.900e-04,9.200e-05,4.100e-05,1.300e-05,&     
       4.300e-06,8.600e-08,4.300e-11/)      
!! Atmospheric aerosols vertical profile (SBDART model aden05: (94% of extinction occurs below 5 km))
REAL, DIMENSION(JPNPREF), PARAMETER::PPAERREF=(/& ! aerosol vertical profile 
       1.378E+04,  5.030E+03,  1.844E+03,  6.731E+02,  2.453E+02,&      
       8.987E+01,  6.337E+01,  5.890E+01,  6.069E+01,  5.818E+01,&
       5.675E+01,  5.317E+01,  5.585E+01,  5.156E+01,  5.048E+01,&
       4.744E+01,  4.511E+01,  4.458E+01,  4.314E+01,  3.634E+01,&
       2.667E+01,  1.933E+01,  1.455E+01,  1.113E+01,  8.826E+00,&
       7.429E+00,  2.238E+00,  5.890E-01,  1.550E-01,  4.082E-02,&
       1.078E-02,  5.550E-05,  1.969E-08/)

!!! Cloud optical properties from Mie calculation 
!! effective cloud droplet size = 8 um
!! HG phase function 
!! from SBDART
INTEGER, PARAMETER :: JPNCLOUDWV=150 ! Nbr of reference wavelengths
REAL, PARAMETER ::PPCLOUDWV1=0.29 ! start wvl in microns 
REAL, PARAMETER :: PPCLOUDWV2=333.33 ! original end wvl in microns (SBDART table)
INTEGER, PARAMETER :: JPNCLOUDWV2=399 ! original number of wvl in SBDART 

! water cloud extinction efficiency 
REAL, DIMENSION(JPNCLOUDWV), PARAMETER :: PPQQ=(/& 
        2.04292679, 2.04345584, 2.04394841, 2.04449677, 2.04498100,&
        2.04555130, 2.04607344, 2.04664254, 2.04707193, 2.04773879,&
        2.04831982, 2.04891729, 2.04947448, 2.05006957, 2.05066252,&
        2.05136728, 2.05188251, 2.05246615, 2.05314517, 2.05378556,&
        2.05458999, 2.05503869, 2.05568361, 2.05637288, 2.05705523,&
        2.05771661, 2.05844760, 2.05907869, 2.05981398, 2.06053400,&
        2.06122065, 2.06193972, 2.06268358, 2.06346512, 2.06412601,&
        2.06501889, 2.06571960, 2.06660628, 2.06734228, 2.06816840,&
        2.06910706, 2.06983709, 2.07069325, 2.07150078, 2.07231116,&
        2.07326126, 2.07406402, 2.07494712, 2.07588601, 2.07678294,&
        2.07762551, 2.07860970, 2.07953358, 2.08056903, 2.08146000,&
        2.08259320, 2.08351636, 2.08446288, 2.08550620, 2.08639598,&
        2.08754086, 2.08863521, 2.08964777, 2.09077358, 2.09197688,&
        2.09304690, 2.09418678, 2.09521651, 2.09642196, 2.09757328,&
        2.09883595, 2.09991646, 2.10112095, 2.10241914, 2.10365915,&
        2.10490036, 2.10601854, 2.10737395, 2.10869360, 2.11008978,&
        2.11148000, 2.11276555, 2.11419702, 2.11561060, 2.11698246,&
        2.11843348, 2.11982489, 2.12152028, 2.12280083, 2.12435079,&
        2.12588573, 2.12740803, 2.12898946, 2.13058972, 2.13220334,&
        2.13388658, 2.13556790, 2.13719106, 2.13896751, 2.14072323,&
        2.14240813, 2.14421701, 2.14604497, 2.14788318, 2.14982080,&
        2.15166569, 2.15351629, 2.15531826, 2.15728188, 2.15936255,&
        2.16149378, 2.16363215, 2.16580367, 2.16800785, 2.17025161,&
        2.17254281, 2.17487764, 2.17727113, 2.17972875, 2.18224859,&
        2.18484569, 2.18752074, 2.19031525, 2.19340110, 2.19677806,&
        2.20011997, 2.20142627, 2.19591856, 2.14499521, 2.11690831,&
        2.13536215, 2.15609050, 2.17118526, 2.18218684, 2.19137931,&
        2.19948387, 2.20612431, 2.21224546, 2.21794057, 2.22267699,&
        2.22710562, 2.23136377, 2.23539996, 2.23923302, 2.24294806,&
        2.24654555, 2.25006080, 2.25352168, 2.25693989, 2.26028681/)
  
! water cloud single scattering albedo
REAL, DIMENSION(JPNCLOUDWV), PARAMETER :: PPWW=(/& 
        0.99999696, 0.99999726, 0.99999750, 0.99999762, 0.99999797,&
        0.99999809, 0.99999815, 0.99999827, 0.99999839, 0.99999851,&
        0.99999857, 0.99999869, 0.99999851, 0.99999887, 0.99999893,&
        0.99999905, 0.99999911, 0.99999917, 0.99999923, 0.99999934,&
        0.99999940, 0.99999946, 0.99999952, 0.99999958, 1.00000000,&
        1.00000000, 1.00000000, 1.00000000, 1.00000000, 1.00000000,&
        1.00000000, 1.00000000, 0.99999946, 0.99999946, 0.99999940,&
        0.99999928, 0.99999917, 0.99999905, 0.99999887, 0.99999857,&
        0.99999809, 0.99999708, 0.99999601, 0.99999577, 0.99999547,&
        0.99999529, 0.99999505, 0.99999428, 0.99999380, 0.99999285,&
        0.99999022, 0.99998415, 0.99997383, 0.99996281, 0.99996006,&
        0.99995869, 0.99996525, 0.99996990, 0.99996901, 0.99996042,&
        0.99994701, 0.99993157, 0.99992120, 0.99991137, 0.99989760,&
        0.99985856, 0.99970168, 0.99946046, 0.99932796, 0.99934280,&
        0.99941963, 0.99953932, 0.99965447, 0.99974871, 0.99977320,&
        0.99972832, 0.99964190, 0.99935168, 0.99853688, 0.99819899,&
        0.99813479, 0.99815875, 0.99823213, 0.99836111, 0.99831593,&
        0.99793899, 0.99714297, 0.99460208, 0.99195045, 0.98254484,&
        0.96055329, 0.95722944, 0.96207827, 0.97324985, 0.98040140,&
        0.98476905, 0.98758531, 0.98984998, 0.99102640, 0.99176180,&
        0.99160558, 0.99072623, 0.98922503, 0.98664337, 0.98614794,&
        0.97925824, 0.92574805, 0.86137813, 0.86548412, 0.89930022,&
        0.93179733, 0.94863033, 0.96115303, 0.96803856, 0.97171205,&
        0.97282249, 0.97062778, 0.96583647, 0.95894688, 0.94711155,&
        0.93085378, 0.90819287, 0.88545144, 0.87800407, 0.86414713,&
        0.79163742, 0.62828273, 0.51430357, 0.49666989, 0.49972558,&
        0.51026201, 0.51780307, 0.52047658, 0.52198386, 0.52193785,&
        0.52046502, 0.51892745, 0.52125508, 0.53972298, 0.57556754,&
        0.63175446, 0.70367491, 0.77106827, 0.81826645, 0.84883434,&
        0.86063880, 0.86081958, 0.85372406, 0.84218729, 0.82511300/)  
     
    
! water cloud single scattering albedo 
REAL, DIMENSION(JPNCLOUDWV), PARAMETER :: PPGG=(/& 
        0.86207455, 0.86257666, 0.86306560, 0.86350971, 0.86396039,&
        0.86435080, 0.86474526, 0.86510903, 0.86551118, 0.86579049,&
        0.86608958, 0.86636627, 0.86664778, 0.86689991, 0.86713850,&
        0.86731941, 0.86756980, 0.86777949, 0.86793941, 0.86810613,&
        0.86819422, 0.86842436, 0.86856353, 0.86867672, 0.86878502,&
        0.86889547, 0.86897022, 0.86908108, 0.86914277, 0.86920488,&
        0.86927605, 0.86932909, 0.86936700, 0.86938471, 0.86944938,&
        0.86941278, 0.86945337, 0.86941302, 0.86943287, 0.86941338,&
        0.86933976, 0.86935657, 0.86931652, 0.86929446, 0.86927021,&
        0.86918890, 0.86915433, 0.86908621, 0.86898899, 0.86890602,&
        0.86884302, 0.86871678, 0.86861378, 0.86846226, 0.86836773,&
        0.86817008, 0.86805546, 0.86793029, 0.86776626, 0.86766773,&
        0.86746418, 0.86728209, 0.86713338, 0.86693603, 0.86671311,&
        0.86655134, 0.86638767, 0.86629379, 0.86610472, 0.86590576,&
        0.86564541, 0.86545140, 0.86521626, 0.86494672, 0.86472255,&
        0.86452222, 0.86438060, 0.86420000, 0.86415708, 0.86398172,&
        0.86374831, 0.86354035, 0.86327761, 0.86300689, 0.86280411,&
        0.86264759, 0.86262721, 0.86290652, 0.86333585, 0.86512309,&
        0.86935747, 0.86975902, 0.86852658, 0.86602479, 0.86433774,&
        0.86320662, 0.86239874, 0.86172986, 0.86127347, 0.86094379,&
        0.86084938, 0.86091030, 0.86112398, 0.86158848, 0.86161458,&
        0.86311716, 0.87385577, 0.88621402, 0.88506049, 0.87830758,&
        0.87197226, 0.86874187, 0.86639869, 0.86522096, 0.86475271,&
        0.86488169, 0.86577117, 0.86727154, 0.86930096, 0.87238264,&
        0.87640309, 0.88168210, 0.88704604, 0.89003420, 0.89466888,&
        0.90973759, 0.94324309, 0.97778761, 0.98319238, 0.97774953,&
        0.96725190, 0.95752180, 0.95237738, 0.94881213, 0.94746643,&
        0.94839060, 0.95002520, 0.94938946, 0.94093490, 0.92652410,&
        0.90686762, 0.88531911, 0.86768013, 0.85658240, 0.84993112,&
        0.84778047, 0.84818071, 0.85008180, 0.85282248, 0.85667843/)

! ice cloud exinction efficiency   
REAL, DIMENSION(JPNCLOUDWV), PARAMETER :: PPQQI=(/& 
        2.04299641, 2.04347539, 2.04397154, 2.04451704, 2.04506326,&
        2.04560447, 2.04616117, 2.04668808, 2.04722118, 2.04781461,&
        2.04820299, 2.04895973, 2.04951787, 2.05010843, 2.05071950,&
        2.05137110, 2.05185175, 2.05260062, 2.05318785, 2.05395913,&
        2.05446959, 2.05514812, 2.05582356, 2.05649710, 2.05714536,&
        2.05781865, 2.05847478, 2.05918527, 2.05989599, 2.06057692,&
        2.06134200, 2.06205177, 2.06284833, 2.06352210, 2.06432819,&
        2.06509495, 2.06589985, 2.06660342, 2.06717896, 2.06852555,&
        2.06905770, 2.06990790, 2.07080817, 2.07158422, 2.07226682,&
        2.07328510, 2.07423162, 2.07507205, 2.07600760, 2.07685685,&
        2.07781148, 2.07885551, 2.07969737, 2.08070087, 2.08161998,&
        2.08258843, 2.08365560, 2.08473372, 2.08580041, 2.08676910,&
        2.08782864, 2.08877134, 2.08989692, 2.09095526, 2.09213519,&
        2.09319067, 2.09428477, 2.09547615, 2.09658313, 2.09778738,&
        2.09897661, 2.10011005, 2.10149837, 2.10259986, 2.10396862,&
        2.10507703, 2.10646129, 2.10773826, 2.10896945, 2.11041689,&
        2.11168885, 2.11318231, 2.11448097, 2.11591959, 2.11749816,&
        2.11876893, 2.12024951, 2.12175417, 2.12322569, 2.12485027,&
        2.12632990, 2.12788272, 2.12945342, 2.13104248, 2.13268542,&
        2.13434601, 2.13610554, 2.13775468, 2.13945580, 2.14126468,&
        2.14306617, 2.14487219, 2.14671803, 2.14857292, 2.15050936,&
        2.15239835, 2.15441132, 2.15635920, 2.15826321, 2.16025925,&
        2.16236067, 2.16449237, 2.16681528, 2.16914415, 2.17150044,&
        2.17390323, 2.17636061, 2.17887998, 2.18144965, 2.18412423,&
        2.18691468, 2.18985009, 2.19295144, 2.19628358, 2.19986343,&
        2.20338345, 2.20646787, 2.21510601, 2.27427673, 2.02623439,&
        1.96984124, 2.07889199, 2.11985946, 2.15826654, 2.18755126,&
        2.19550347, 2.20106816, 2.20624042, 2.21179318, 2.21740007,&
        2.22268200, 2.22741389, 2.23185277, 2.23590779, 2.23963594,&
	2.24341941, 2.24704337, 2.25049043, 2.25383401, 2.25716782/)

! ice cloud single scattering albedo 
REAL, DIMENSION(JPNCLOUDWV), PARAMETER :: PPWWI=(/& 
        0.99999255, 0.99999309, 0.99999279, 0.99999404, 0.99999464,&
        0.99999493, 0.99999529, 0.99999571, 0.99999601, 0.99999624,&
        0.99999660, 0.99999696, 0.99999732, 0.99999768, 0.99999803,&
        0.99999815, 0.99999851, 0.99999857, 0.99999863, 0.99999881,&
        0.99999893, 0.99999881, 0.99999911, 0.99999911, 0.99999923,&
        0.99999934, 0.99999940, 0.99999940, 0.99999934, 0.99999934,&
        0.99999934, 0.99999928, 0.99999917, 0.99999917, 0.99999881,&
        0.99999899, 0.99999893, 0.99999893, 0.99999893, 0.99999809,&
        0.99999851, 0.99999815, 0.99999791, 0.99999726, 0.99999696,&
        0.99999636, 0.99999559, 0.99999505, 0.99999440, 0.99999344,&
        0.99999213, 0.99998975, 0.99998909, 0.99998736, 0.99998432,&
        0.99997973, 0.99997497, 0.99996978, 0.99996734, 0.99996513,&
        0.99996489, 0.99995852, 0.99994528, 0.99992365, 0.99990976,&
        0.99990642, 0.99989688, 0.99988323, 0.99983799, 0.99977738,&
        0.99970424, 0.99960148, 0.99957687, 0.99962360, 0.99968183,&
        0.99970078, 0.99969620, 0.99965364, 0.99961960, 0.99936873,&
        0.99907732, 0.99860591, 0.99823815, 0.99805254, 0.99803793,&
        0.99810493, 0.99812859, 0.99808371, 0.99796081, 0.99746168,&
        0.99253482, 0.97918892, 0.95365870, 0.94124472, 0.94728035,&
        0.95563769, 0.96564090, 0.97206491, 0.97465980, 0.97823447,&
        0.98144251, 0.98408943, 0.98554575, 0.98646468, 0.98749626,&
        0.98761821, 0.97887510, 0.94689888, 0.89689791, 0.87795103,&
        0.88475353, 0.90256238, 0.93221515, 0.95957702, 0.97388685,&
        0.98063713, 0.98331034, 0.97973824, 0.97038430, 0.96185732,&
        0.95698440, 0.95235258, 0.94737762, 0.94578707, 0.94228941,&
        0.89902043, 0.81365240, 0.69449663, 0.59222209, 0.49761581,&
        0.49292842, 0.52717292, 0.53816378, 0.55289865, 0.55370462,&
        0.54589027, 0.53834963, 0.53107214, 0.52626503, 0.52990526,&
        0.55941999, 0.61633766, 0.68808460, 0.73487920, 0.75284362,&
        0.76842284, 0.76854503, 0.75321376, 0.73104674, 0.71541166/)
      
! ice cloud assymetry factor

REAL, DIMENSION(JPNCLOUDWV), PARAMETER :: PPGGI=(/& 
        0.87489736, 0.87536228, 0.87580419, 0.87601978, 0.87623501,&
        0.87644792, 0.87665993, 0.87689215, 0.87713051, 0.87734789,&
        0.87764251, 0.87774098, 0.87784582, 0.87795979, 0.87807024,&
        0.87815166, 0.87831157, 0.87835789, 0.87845975, 0.87846845,&
        0.87857407, 0.87858820, 0.87860405, 0.87861580, 0.87863743,&
        0.87864137, 0.87864751, 0.87862623, 0.87860060, 0.87858325,&
        0.87852675, 0.87849015, 0.87841409, 0.87838513, 0.87829834,&
        0.87822765, 0.87812150, 0.87808865, 0.87809438, 0.87776786,&
        0.87778407, 0.87766737, 0.87752956, 0.87743974, 0.87739658,&
        0.87720048, 0.87703884, 0.87692267, 0.87676561, 0.87664968,&
        0.87648410, 0.87628216, 0.87616801, 0.87598616, 0.87584031,&
        0.87567508, 0.87547106, 0.87526476, 0.87506282, 0.87490451,&
        0.87471068, 0.87456602, 0.87435168, 0.87417197, 0.87394166,&
        0.87375855, 0.87356663, 0.87334198, 0.87316120, 0.87294936,&
        0.87274522, 0.87257886, 0.87229490, 0.87211519, 0.87182957,&
        0.87166476, 0.87139982, 0.87119293, 0.87101024, 0.87079394,&
        0.87066066, 0.87049103, 0.87038189, 0.87018633, 0.86990988,&
        0.86973697, 0.86951125, 0.86929208, 0.86912382, 0.86900789,&
        0.86991549, 0.87243515, 0.87710911, 0.87919140, 0.87782729,&
        0.87602842, 0.87392509, 0.87254107, 0.87187999, 0.87102556,&
        0.87026834, 0.86964446, 0.86927855, 0.86905372, 0.86878699,&
        0.86880833, 0.87063873, 0.87685049, 0.88602275, 0.88939589,&
        0.88808012, 0.88485980, 0.87957078, 0.87481499, 0.87254775,&
        0.87176722, 0.87187141, 0.87332505, 0.87585932, 0.87834668,&
        0.88025701, 0.88232601, 0.88468713, 0.88688713, 0.89011818,&
        0.90051132, 0.91849756, 0.94621319, 0.97738570, 0.99166113,&
        0.98353404, 0.96022242, 0.94422466, 0.91996735, 0.90798366,&
        0.91369164, 0.92208660, 0.93176490, 0.93848187, 0.93865818,&
        0.92570221, 0.90386218, 0.88089544, 0.86870730, 0.86527020,&
        0.86260271, 0.86380816, 0.86881191, 0.87544841, 0.87994230/)
      
  
INTEGER, PARAMETER :: JPNLYR_CLEAR=6 ! number of atmospheric layer for clear sky 
INTEGER, PARAMETER :: JPNLYR_CLOUD=JPNLYR_CLEAR+ 1!number of atmospheric layer for cloudy sky 
REAL, PARAMETER :: PPWL_REF_CLOUD=0.55 ! reference wavelength for cloud in microns
REAL, PARAMETER :: PPWRAY_EFF=0.9999999 ! effective rayleigh single scattering albedo to prevent non inversible matrix
REAL, PARAMETER :: PPGRAY=0.5 ! assymetry factor for rayleigh scattering
REAL, PARAMETER :: PPCLOUD_THRES=0.0001 ! threshold for cloudy simulation
! Atmospheric layering (Pa)
REAL , DIMENSION(JPNLYR_CLEAR-1), PARAMETER :: PPZP_CUT=(/900.,800.,700.,500.,378./)*100.
REAL, PARAMETER :: PZERO=1013.25*100.       ! standard pressure (Pa)


! Parameter for relative air mass calculation (Kasten&young1989)
REAL, PARAMETER :: PPA1=0.050572
REAL, PARAMETER :: PPB1=96.07995
REAL, PARAMETER :: PPC1=1.6364
REAL, PARAMETER ::PPDEG=180.
! Parameter for rayleigh molecular scattering (Nicolet et al., 1984)
REAL, PARAMETER :: PPA2=4.02e-28
REAL, PARAMETER :: PPB2=0.389
REAL, PARAMETER :: PPC2=0.09426
REAL, PARAMETER ::PPD2=0.3228
REAL, PARAMETER :: PPE2=4.
REAL, PARAMETER :: PPF2=0.04
REAL, PARAMETER ::PPTEN=10.

!Parameter for water column to RH
REAL, PARAMETER ::PPWAT1=46.5
REAL, PARAMETER ::PPHUND=100.

! Parameter for water vapour absorption
REAL, PARAMETER ::PPWATA=0.2385
REAL, PARAMETER ::PPWATB=20.07
REAL, PARAMETER ::PPWATC=0.45

! Parameter for ozone absorption (Ibqual, 1983)
REAL, PARAMETER :: PPHO=22. !heigth of maximum ozone concentration (km)
REAL, PARAMETER :: PPO1=6370.
REAL, PARAMETER :: PPO2=2.

! Parameter for uniformely mixed gaz absorption (Leckner)
REAL, PARAMETER ::PPU1=1.41
REAL, PARAMETER ::PPU2=118.93
REAL, PARAMETER ::PPU3=0.45

! Parameter for aerosol scatter and abs (Shettle and Fenn 1975)
REAL, PARAMETER :: PPAER1=1.2060
REAL, PARAMETER ::PPAER2=1.0274
REAL, PARAMETER ::PPAER3=0.5

! Parameter for aerosols and humidity
REAL, PARAMETER :: PPSMALL=.00000001
REAL, DIMENSION(4), PARAMETER :: PPHUM_ZONE=(/0.,0.7,0.8,0.99/)
REAL, PARAMETER ::PPHUM1=0.7
REAL, PARAMETER ::PPHUM2=0.8

! Parameter for saturation pressure calculation 
REAL, PARAMETER :: PPTEMP1=173.0
REAL, PARAMETER :: PPTEMP2=273.15
REAL, DIMENSION(7), PARAMETER :: PPPA0W =(/ 6984.505294,& !Lowe's polynomials for vapor pressure(water)
 -188.9039310,2.133357675,-1.288580973e-2,&
4.393587233e-5,-8.023923082e-8,6.136820929e-11/)
REAL, DIMENSION(7), PARAMETER :: PPPA0 = (/6.109177956,& !Lowe's polynomials for vapor pressure(ice)
5.03469897e-1,1.886013408e-2,4.176223716e-4,5.824720280e-6,&
4.838803174e-8,1.838826904e-10/)


! Rayleigh scattering parameter in Bucholtz calculation
REAL, PARAMETER :: PPWL_REF_RAY=0.5
REAL,DIMENSION(4), PARAMETER :: ZRAY1=(/3.01577E-28,&
3.55212,1.35576,0.11563/)
REAL,DIMENSION(4), PARAMETER :: ZRAY2=(/4.01061E-28,&
3.99668,1.10298e-3,2.71393e-2/)

! Parameter for specific to relative humidity conversion 
REAL, PARAMETER ::PPHUMA=0.622
REAL, PARAMETER :: PPHUMB=0.378

! Parameter for calculation of cloud optical thickness (for SBDART run fit mid-latitude winter)
REAL, PARAMETER :: PPCLOUD1=-0.804768210877
REAL, PARAMETER :: PPCLOUD2=1.93781657065
REAL, PARAMETER :: PPCLOUD3=-1.67394248017
REAL, PARAMETER :: PPCLOUD4=0.774164716774
REAL, PARAMETER :: PPCLOUDMAX=64. ! max cloud optical depth

END MODULE MODD_CONST_ATM
